"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};exports.default=({configs,mongo},client)=>async(id,data)=>{const db=await client;const col=await db.collection(configs.database.mongo.collections.users);const user=await col.findOne({_id:mongo.ObjectId(id)},{password:!1});const availableData=await col.findOne({$or:[{nickname:data.nickname},{name:data.name},{email:data.email}]},{nickname:!0,name:!0,email:!0});if(availableData){if(availableData.nickname===data.nickname){throw configs.response.alreadyTakenNickname}if(availableData.name===data.name){throw configs.response.alreadyTakenName}if(availableData.email===data.email){throw configs.response.alreadyTakenEmail}}const newUserData=_extends({},user,data);await col.findOneAndUpdate({_id:mongo.ObjectId(id)},newUserData);return!0};