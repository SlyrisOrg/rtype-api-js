"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _userSignin=require("./userSignin");var _userSignin2=_interopRequireDefault(_userSignin);var _userSignup=require("./userSignup");var _userSignup2=_interopRequireDefault(_userSignup);var _userFetch=require("./userFetch");var _userFetch2=_interopRequireDefault(_userFetch);var _userUpdate=require("./userUpdate");var _userUpdate2=_interopRequireDefault(_userUpdate);var _userCreate=require("./userCreate");var _userCreate2=_interopRequireDefault(_userCreate);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const verifyTokenMiddleware=({jwt,configs})=>async(req,res,next)=>{try{const token=req.get("Authorization").substring(4);const data=await jwt.verify(token,configs.server.secret);if(!data||!data._id){throw configs.response.unvalidToken.payload}req.user=data._id;next()}catch(err){res.render("error",err)}};exports.default=deps=>router=>{router.get("/",verifyTokenMiddleware(deps),(0,_userFetch2.default)(deps));router.put("/",verifyTokenMiddleware(deps),(0,_userUpdate2.default)(deps));router.post("/",verifyTokenMiddleware(deps),(0,_userCreate2.default)(deps));router.post("/signin",(0,_userSignin2.default)(deps));router.post("/signup",(0,_userSignup2.default)(deps));return router};