"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};exports.default=({verifier,database,logger,configs})=>async(req,res)=>{try{const pre=Object.keys({name:req.body.name,email:req.body.email,password:req.body.password}).filter(key=>!!req.body[key]).reduce((object,key)=>_extends({},object,{[key]:req.body[key]}),{});if(!pre.name&&!pre.email){throw configs.response.emptyCredential}const body=await verifier.user(pre);const token=await database.signinUser(body);res.render("success",{content:{token}})}catch(err){logger.error("Signup controller",err);res.render("error",err)}};